import tweepyimport secretimport jsonfrom app import models, db#override tweepy.StreamListener to add logic to on_statusclass MyStreamListener(tweepy.StreamListener):    def on_status(self, status):      # twitter_data = {}      # twitter_data["status"] = status.text.encode('utf-8')       # twitter_data["created_at"] = status.created_at      # twitter_data["username"] = status.user.screen_name.encode('utf-8')       # twitter_data["location"] = status.user.location      # print twitter_data      tweets = models.Tweets(                     username=status.user.screen_name.encode('utf-8'),                     location=status.user.location,                     created_at=status.created_at,                     text=status.text.encode('utf-8')                     )      db.session.add(tweets)      db.session.commit()    # def text_parsing(self, text):          # def on_data(self, data):    #     print data    #     return True    def on_error(self, status_code):        if status_code == 420:            #returning False in on_data disconnects the stream            return False        print status_codemyStreamListener = MyStreamListener()myStream = tweepy.Stream(auth = secret.auth, listener=myStreamListener)myStream.filter(track=['@Olympics', '@NBCOlympics'])# process output to json# # # # # API: Get all active listings# Only include data that is needed for sorting, filtering,# and viewing in a list and map in the client.# TODO: the listing document generation shouldn't be done here# @app.route('/api/listings.json')# def api_listings():#   listings = Listing.query.filter_by(suspend=False)#   output = []#   for listing in listings:#     output.append({#       "id": listing.id,#       "addr": listing.addr,#       "name": listing.name,#       "contact": {#         "id": listing.manager.id,#         "name": listing.manager.contact_name,#         "company": listing.manager.contact_company,#         "email": listing.manager.contact_email,#         "phone": listing.manager.contact_phone#       },#       "location": {#         "distance": listing.distance,#         "duration": listing.duration,#         "lat": listing.lat,#         "lng": listing.lng#       },#       "bedrooms": listing.bedrooms,#       "bathrooms": listing.bathrooms,#       "rent": listing.rent,#       "photos": listing.get_photo_urls()#     })#   return json.dumps(output)